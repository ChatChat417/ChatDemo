# 角色扮演聊天 API 文档

## 概述
该API提供角色扮演聊天功能，用户可以与具有特定性格的AI角色在设定场景中进行互动。API支持动态的角色性格设定和场景设置。

## 基础URL
```
http://localhost:8000/api/v1
```

## 接口说明

### 发送聊天消息
向AI角色发送消息并获取回复。

**接口地址：** `POST /chat`

**请求参数格式**
```json
{
    "character": {
        "name": string,       // 角色名称
        "background": string, // 角色背景故事
        "personality": string // 角色性格特征
    },
    "scene": {
        "description": string, // 当前场景描述
        "mood": string        // 场景氛围
    },
    "message": string,        // 用户消息
    "message_history": [      // 历史消息数组
        {
            "role": string,   // "user"(用户) 或 "assistant"(助手)
            "content": string // 消息内容
        }
    ]
}
```

**请求示例**
```json
{
    "character": {
        "name": "Jake",
        "background": "本地乐队的贝斯手，热爱夜间冒险",
        "personality": "随性，爱调情，喜欢逗人开心"
    },
    "scene": {
        "description": "在一个安静的实验室里,四周是闪烁的量子计算机显示屏",
        "mood": "专注而平静"
    },
    "message": "你好",
    "message_history": [
        {
            "role": "assistant",
            "content": "嘿，你好啊 😉"
        },
        {
            "role": "user",
            "content": "你好"
        }
    ]
}
```

**返回格式**
```json
{
    "response": string // AI角色的回复消息
}
```

**返回示例**
```json
{
    "response": "嘿！今天是什么风把你吹到我的实验室来了？😉"
}
```

### 状态码说明
- 200: 请求成功
- 400: 请求参数错误
- 500: 服务器内部错误

## 注意事项
1. 消息历史需要在客户端维护，并在每次请求时发送，以提供对话上下文
2. 角色和场景信息在整个对话会话中应保持一致
3. API要求所有字符串输入不能为空且格式正确

## 预设角色列表
系统包含以下预设角色可供使用：

1. Jake (音乐人)
   - 背景：本地乐队的贝斯手，热爱夜间冒险
   - 性格：随性，爱调情，喜欢逗人开心
   - 默认打招呼：「嘿，你好啊 😉」

2. Emma (模特)
   - 背景：兼职模特，摄影爱好者
   - 性格：自信，活泼，善于互动
   - 默认打招呼：「你好啊，可爱的 ✨」

3. Alex (调酒师)
   - 背景：高档酒吧的调酒师，了解所有最棒的地方
   - 性格：迷人，善于言谈，擅长读懂他人
   - 默认打招呼：「最近怎么样？😏」

4. Sophia (舞者)
   - 背景：舞蹈工作室的专业舞者
   - 性格：爱调情，优雅，享受美好氛围
   - 默认打招呼：「嗨～ 💋」

## 错误处理
常见错误及其处理方式：

### 400 错误（请求参数错误）
可能的原因：
- 缺少必需的字段
- 字段格式错误
- 字符串字段为空

示例错误响应：
```json
{
    "error": "invalid_request",
    "message": "缺少必需的character字段"
}
```

### 500 错误（服务器错误）
可能的原因：
- 服务器内部处理错误
- 数据库连接失败
- AI模型响应超时

示例错误响应：
```json
{
    "error": "internal_server_error",
    "message": "服务器处理请求时发生错误"
}
```
